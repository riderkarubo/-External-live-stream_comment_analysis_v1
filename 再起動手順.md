# Streamlitアプリの再起動手順

## 問題が発生した場合

UIが更新されない、新しい機能が反映されない場合は、以下の手順でアプリを再起動してください。

## 方法1: 再起動スクリプトを使用（推奨）

プロジェクトルートで以下のコマンドを実行：

```bash
./restart_app.sh
```

このスクリプトは以下を自動実行します：
- Pythonキャッシュ（`__pycache__`）の削除
- 実行中のStreamlitプロセスの停止
- 仮想環境のアクティベート
- Streamlitアプリの起動

## 方法2: 手動で再起動

### ステップ1: 実行中のStreamlitを停止

Streamlitアプリが実行中のターミナルで：
- `Ctrl + C` を押して停止

または、別のターミナルで：
```bash
pkill -f "streamlit run app.py"
```

### ステップ2: Pythonキャッシュをクリア

```bash
cd /Users/issy_s/コーディング/live-stream_comment_analysis

# キャッシュディレクトリを削除
find . -type d -name "__pycache__" -exec rm -r {} + 2>/dev/null || true

# キャッシュファイルを削除
find . -type f -name "*.pyc" -delete 2>/dev/null || true
find . -type f -name "*.pyo" -delete 2>/dev/null || true
```

### ステップ3: 仮想環境をアクティベート

```bash
source env/bin/activate
```

### ステップ4: Streamlitアプリを起動

```bash
streamlit run app.py
```

### ステップ5: ブラウザのキャッシュをクリア

ブラウザでアプリを開いた後：
- **Mac**: `Cmd + Shift + R`
- **Windows/Linux**: `Ctrl + Shift + R`

でハードリロードを実行してください。

## 確認事項

再起動後、以下が正しく動作することを確認してください：

1. **統合プロンプトによる高速化（約50%）**
   - 分析が以前より速く完了する
   - 1回のAPI呼び出しで属性と感情の両方を取得

2. **PCスリープ対策**
   - 分析途中でPCがスリープしても、ページをリロードすると「続きから再開」ボタンが表示される
   - 分析結果が10件ごとに自動保存される

3. **再開機能**
   - 分析が中断された場合、「続きから再開」ボタンが表示される
   - ボタンをクリックすると、中断した箇所から再開される

## トラブルシューティング

### スクリプトが実行できない場合

```bash
chmod +x restart_app.sh
```

で実行権限を付与してください。

### 仮想環境が見つからない場合

仮想環境を再作成：
```bash
python -m venv env
source env/bin/activate
pip install -r requirements.txt
```

### ポートが既に使用されている場合

別のポートで起動：
```bash
streamlit run app.py --server.port 8502
```

